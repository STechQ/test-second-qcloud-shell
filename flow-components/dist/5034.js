"use strict";exports.id=5034,exports.ids=[5034],exports.modules={5034:(e,t,r)=>{var o,n,s,i,a,c,u,f,h;r.r(t),r.d(t,{fromHttp:()=>ie}),function(e){e.HEADER="header",e.QUERY="query"}(o||(o={})),function(e){e.HEADER="header",e.QUERY="query"}(n||(n={})),function(e){e.HTTP="http",e.HTTPS="https"}(s||(s={})),(a=i||(i={})).MD5="md5",a.CRC32="crc32",a.CRC32C="crc32c",a.SHA1="sha1",a.SHA256="sha256",(h=c||(c={}))[h.HEADER=0]="HEADER",h[h.TRAILER=1]="TRAILER",function(e){e.PROFILE="profile",e.SSO_SESSION="sso-session",e.SERVICES="services"}(u||(u={})),function(e){e.HTTP_0_9="http/0.9",e.HTTP_1_0="http/1.0",e.TDS_8_0="tds/8.0"}(f||(f={}));class l{constructor(e){this.method=e.method||"GET",this.hostname=e.hostname||"localhost",this.port=e.port,this.query=e.query||{},this.headers=e.headers||{},this.body=e.body,this.protocol=e.protocol?":"!==e.protocol.slice(-1)?`${e.protocol}:`:e.protocol:"https:",this.path=e.path?"/"!==e.path.charAt(0)?`/${e.path}`:e.path:"/",this.username=e.username,this.password=e.password,this.fragment=e.fragment}static clone(e){const t=new l({...e,headers:{...e.headers}});var r;return t.query&&(t.query=(r=t.query,Object.keys(r).reduce(((e,t)=>{const o=r[t];return{...e,[t]:Array.isArray(o)?[...o]:o}}),{}))),t}static isInstance(e){if(!e)return!1;const t=e;return"method"in t&&"protocol"in t&&"hostname"in t&&"path"in t&&"object"==typeof t.query&&"object"==typeof t.headers}clone(){return l.clone(this)}}class d{constructor(e){this.statusCode=e.statusCode,this.reason=e.reason,this.headers=e.headers||{},this.body=e.body}static isInstance(e){if(!e)return!1;const t=e;return"number"==typeof t.statusCode&&"object"==typeof t.headers}}const p=e=>encodeURIComponent(e).replace(/[!'()*]/g,y),y=e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`;var g=r(3685),m=r(5687);const b=["ECONNRESET","EPIPE","ETIMEDOUT"],w=e=>{const t={};for(const r of Object.keys(e)){const o=e[r];t[r]=Array.isArray(o)?o.join(","):o}return t};var T=r(2781);class E{static create(e){return"function"==typeof e?.handle?e:new E(e)}static checkSocketUsage(e,t,r=console){const{sockets:o,requests:n,maxSockets:s}=e;if("number"!=typeof s||s===1/0)return t;if(Date.now()-15e3<t)return t;if(o&&n)for(const e in o){const t=o[e]?.length??0,i=n[e]?.length??0;if(t>=s&&i>=2*s)return r?.warn?.(`@smithy/node-http-handler:WARN - socket usage at capacity=${t} and ${i} additional requests are enqueued.\nSee https://docs.aws.amazon.com/sdk-for-javascript/v3/developer-guide/node-configuring-maxsockets.html\nor increase socketAcquisitionWarningTimeout=(millis) in the NodeHttpHandler config.`),Date.now()}return t}constructor(e){this.socketWarningTimestamp=0,this.metadata={handlerProtocol:"http/1.1"},this.configProvider=new Promise(((t,r)=>{"function"==typeof e?e().then((e=>{t(this.resolveDefaultConfig(e))})).catch(r):t(this.resolveDefaultConfig(e))}))}resolveDefaultConfig(e){const{requestTimeout:t,connectionTimeout:r,socketTimeout:o,httpAgent:n,httpsAgent:s}=e||{};return{connectionTimeout:r,requestTimeout:t??o,httpAgent:n instanceof g.Agent||"function"==typeof n?.destroy?n:new g.Agent({keepAlive:!0,maxSockets:50,...n}),httpsAgent:s instanceof m.Agent||"function"==typeof s?.destroy?s:new m.Agent({keepAlive:!0,maxSockets:50,...s}),logger:console}}destroy(){this.config?.httpAgent?.destroy(),this.config?.httpsAgent?.destroy()}async handle(e,{abortSignal:t}={}){let r;return this.config||(this.config=await this.configProvider),new Promise(((o,n)=>{let s;const i=async e=>{await s,clearTimeout(r),n(e)};if(!this.config)throw new Error("Node HTTP request handler config is not resolved");if(t?.aborted){const e=new Error("Request aborted");return e.name="AbortError",void i(e)}const a="https:"===e.protocol,c=a?this.config.httpsAgent:this.config.httpAgent;r=setTimeout((()=>{this.socketWarningTimestamp=E.checkSocketUsage(c,this.socketWarningTimestamp,this.config.logger)}),this.config.socketAcquisitionWarningTimeout??(this.config.requestTimeout??2e3)+(this.config.connectionTimeout??1e3));const u=function(e){const t=[];for(let r of Object.keys(e).sort()){const o=e[r];if(r=p(r),Array.isArray(o))for(let e=0,n=o.length;e<n;e++)t.push(`${r}=${p(o[e])}`);else{let e=r;(o||"string"==typeof o)&&(e+=`=${p(o)}`),t.push(e)}}return t.join("&")}(e.query||{});let f;null==e.username&&null==e.password||(f=`${e.username??""}:${e.password??""}`);let h=e.path;u&&(h+=`?${u}`),e.fragment&&(h+=`#${e.fragment}`);const l={headers:e.headers,host:e.hostname,method:e.method,path:h,port:e.port,agent:c,auth:f},y=(a?m.request:g.request)(l,(e=>{(async e=>{await s,clearTimeout(r),o(e)})({response:new d({statusCode:e.statusCode||-1,reason:e.statusMessage,headers:w(e.headers),body:e})})}));if(y.on("error",(e=>{b.includes(e.code)?i(Object.assign(e,{name:"TimeoutError"})):i(e)})),((e,t,r=0)=>{if(!r)return;const o=setTimeout((()=>{e.destroy(),t(Object.assign(new Error(`Socket timed out without establishing a connection within ${r} ms`),{name:"TimeoutError"}))}),r);e.on("socket",(e=>{e.connecting?e.on("connect",(()=>{clearTimeout(o)})):clearTimeout(o)}))})(y,i,this.config.connectionTimeout),((e,t,r=0)=>{e.setTimeout(r,(()=>{e.destroy(),t(Object.assign(new Error(`Connection timed out after ${r} ms`),{name:"TimeoutError"}))}))})(y,i,this.config.requestTimeout),t){const e=()=>{y.destroy();const e=new Error("Request aborted");e.name="AbortError",i(e)};if("function"==typeof t.addEventListener){const r=t;r.addEventListener("abort",e,{once:!0}),y.once("close",(()=>r.removeEventListener("abort",e)))}else t.onabort=e}const A=l.agent;"object"==typeof A&&"keepAlive"in A&&((e,{keepAlive:t,keepAliveMsecs:r})=>{!0===t&&e.on("socket",(e=>{e.setKeepAlive(t,r||0)}))})(y,{keepAlive:A.keepAlive,keepAliveMsecs:A.keepAliveMsecs}),s=async function(e,t,r=1e3){const o=t.headers??{},n=o.Expect||o.expect;let s=-1,i=!1;"100-continue"===n&&await Promise.race([new Promise((e=>{s=Number(setTimeout(e,Math.max(1e3,r)))})),new Promise((t=>{e.on("continue",(()=>{clearTimeout(s),t()})),e.on("error",(()=>{i=!0,clearTimeout(s),t()}))}))]),i||function(e,t){if(t instanceof T.Readable)t.pipe(e);else{if(t){if(Buffer.isBuffer(t)||"string"==typeof t)return void e.end(t);const r=t;return"object"==typeof r&&r.buffer&&"number"==typeof r.byteOffset&&"number"==typeof r.byteLength?void e.end(Buffer.from(r.buffer,r.byteOffset,r.byteLength)):void e.end(Buffer.from(t))}e.end()}}(e,t.body)}(y,e,this.config.requestTimeout).catch((e=>(clearTimeout(r),n(e))))}))}updateHttpClientConfig(e,t){this.config=void 0,this.configProvider=this.configProvider.then((r=>({...r,[e]:t})))}httpHandlerConfigs(){return this.config??{}}}r(5158);class A{constructor(e){this.sessions=[],this.sessions=e??[]}poll(){if(this.sessions.length>0)return this.sessions.shift()}offerLast(e){this.sessions.push(e)}contains(e){return this.sessions.includes(e)}remove(e){this.sessions=this.sessions.filter((t=>t!==e))}[Symbol.iterator](){return this.sessions[Symbol.iterator]()}destroy(e){for(const t of this.sessions)t===e&&(t.destroyed||t.destroy())}}class v extends T.Writable{constructor(){super(...arguments),this.bufferedBytes=[]}_write(e,t,r){this.bufferedBytes.push(e),r()}}const S=e=>R(e)?async function(e){const t=[],r=e.getReader();let o=!1,n=0;for(;!o;){const{done:e,value:s}=await r.read();s&&(t.push(s),n+=s.length),o=e}const s=new Uint8Array(n);let i=0;for(const e of t)s.set(e,i),i+=e.length;return s}(e):new Promise(((t,r)=>{const o=new v;e.pipe(o),e.on("error",(e=>{o.end(),r(e)})),o.on("error",r),o.on("finish",(function(){const e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))})),R=e=>"function"==typeof ReadableStream&&e instanceof ReadableStream;class C extends Error{constructor(e,t=!0){let r,o=!0;"boolean"==typeof t?(r=void 0,o=t):null!=t&&"object"==typeof t&&(r=t.logger,o=t.tryNextLink??!0),super(e),this.name="ProviderError",this.tryNextLink=o,Object.setPrototypeOf(this,C.prototype),r?.debug?.(`@smithy/property-provider ${o?"->":"(!)"} ${e}`)}static from(e,t=!0){return Object.assign(new this(e.message,t),e)}}class O extends C{constructor(e,t=!0){super(e,t),this.name="CredentialsProviderError",Object.setPrototypeOf(this,O.prototype)}}var k=r(3292),N=r.n(k),I=r(4300);const $=(e,t=0,r=e.byteLength-t)=>{if(o=e,!("function"==typeof ArrayBuffer&&o instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(o)))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);var o;return I.Buffer.from(e,t,r)},x=(e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?I.Buffer.from(e,t):I.Buffer.from(e)},_=/^[A-Za-z0-9+/]*={0,2}$/;class U extends Uint8Array{static fromString(e,t="utf-8"){if("string"==typeof e)return transformFromString(e,t);throw new Error(`Unsupported conversion from ${typeof e} to Uint8ArrayBlobAdapter.`)}static mutate(e){return Object.setPrototypeOf(e,U.prototype),e}transformToString(e="utf-8"){return transformToString(this,e)}}var P=r(3837);const L={},j={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),L[e]=t,j[t]=e}const q=e=>"function"==typeof ReadableStream&&(e?.constructor?.name===ReadableStream.name||e instanceof ReadableStream),B="The stream has already been transformed.",D=e=>"function"==typeof Blob&&e instanceof Blob,H="The stream has already been transformed.",F=Math.ceil(2**127*(2-2**-23)),W=(e,t)=>{const r=(e=>{if(null!=e){if(Number.isInteger(e)&&!Number.isNaN(e))return e;throw new TypeError(`Expected integer, got ${typeof e}: ${e}`)}})(e);if(void 0!==r&&M(r,t)!==r)throw new TypeError(`Expected ${t}-bit integer, got ${e}`);return r},M=(e,t)=>{switch(t){case 32:return Int32Array.of(e)[0];case 16:return Int16Array.of(e)[0];case 8:return Int8Array.of(e)[0]}},K=/(-?(?:0|[1-9]\d*)(?:\.\d+)?(?:[eE][+-]?\d+)?)|(-?Infinity)|(NaN)/g,z=e=>{const t=e.match(K);if(null===t||t[0].length!==e.length)throw new TypeError("Expected real number, got implicit NaN");return parseFloat(e)},J={warn:console.warn},Z=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],V=new RegExp(/^(\d{4})-(\d{2})-(\d{2})[tT](\d{2}):(\d{2}):(\d{2})(?:\.(\d+))?[zZ]$/),Y=e=>{if(null==e)return;if("string"!=typeof e)throw new TypeError("RFC-3339 date-times must be expressed as strings");const t=V.exec(e);if(!t)throw new TypeError("Invalid RFC-3339 date-time value");const[r,o,n,s,i,a,c,u]=t,f=(e=>(e=>W(e,16))("string"==typeof e?z(e):e))(oe(o)),h=te(n,"month",1,12),l=te(s,"day",1,31);return Q(f,h,l,{hours:i,minutes:a,seconds:c,fractionalMilliseconds:u})},Q=(e,t,r,o)=>{const n=t-1;return X(e,n,r),new Date(Date.UTC(e,n,r,te(o.hours,"hour",0,23),te(o.minutes,"minute",0,59),te(o.seconds,"seconds",0,60),re(o.fractionalMilliseconds)))},G=[31,28,31,30,31,30,31,31,30,31,30,31],X=(e,t,r)=>{let o=G[t];if(1===t&&ee(e)&&(o=29),r>o)throw new TypeError(`Invalid day for ${Z[t]} in ${e}: ${r}`)},ee=e=>e%4==0&&(e%100!=0||e%400==0),te=(e,t,r,o)=>{const n=(e=>(e=>W(e,8))("string"==typeof e?z(e):e))(oe(e));if(n<r||n>o)throw new TypeError(`${t} must be between ${r} and ${o}, inclusive`);return n},re=e=>null==e?0:1e3*(e=>(e=>{const t=(e=>{if(null!=e){if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return String(t)!==String(e)&&J.warn((e=>String(new TypeError(e).stack||e).split("\n").slice(0,5).filter((e=>!e.includes("stackTraceWarning"))).join("\n"))(`Expected number but observed string: ${e}`)),t}if("number"==typeof e)return e;throw new TypeError(`Expected number, got ${typeof e}: ${e}`)}})(e);if(void 0!==t&&!Number.isNaN(t)&&t!==1/0&&t!==-1/0&&Math.abs(t)>F)throw new TypeError(`Expected 32-bit float, got ${e}`);return t})("string"==typeof e?z(e):e))("0."+e),oe=e=>{let t=0;for(;t<e.length-1&&"0"===e.charAt(t);)t++;return 0===t?e:e.slice(t)};class ne extends Error{constructor(e){super(e.message),Object.setPrototypeOf(this,ne.prototype),this.name=e.name,this.$fault=e.$fault,this.$metadata=e.$metadata}}const se=function(){const e=Object.getPrototypeOf(this).constructor,t=new(Function.bind.apply(String,[null,...arguments]));return Object.setPrototypeOf(t,e.prototype),t};se.prototype=Object.create(String.prototype,{constructor:{value:se,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(se,String);const ie=(e={})=>{let t;e.logger?.debug("@aws-sdk/credential-provider-http - fromHttp");const r=e.awsContainerCredentialsRelativeUri??process.env.AWS_CONTAINER_CREDENTIALS_RELATIVE_URI,o=e.awsContainerCredentialsFullUri??process.env.AWS_CONTAINER_CREDENTIALS_FULL_URI,n=e.awsContainerAuthorizationToken??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN,s=e.awsContainerAuthorizationTokenFile??process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN_FILE,i="NoOpLogger"!==e.logger?.constructor?.name&&e.logger?e.logger.warn:console.warn;if(r&&o&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerCredentialsRelativeUri and awsContainerCredentialsFullUri."),i("awsContainerCredentialsFullUri will take precedence.")),n&&s&&(i("@aws-sdk/credential-provider-http: you have set both awsContainerAuthorizationToken and awsContainerAuthorizationTokenFile."),i("awsContainerAuthorizationToken will take precedence.")),o)t=o;else{if(!r)throw new O("No HTTP credential provider host provided.\nSet AWS_CONTAINER_CREDENTIALS_FULL_URI or AWS_CONTAINER_CREDENTIALS_RELATIVE_URI.",{logger:e.logger});t=`http://169.254.170.2${r}`}const a=new URL(t);((e,t)=>{if("https:"!==e.protocol&&"169.254.170.2"!==e.hostname&&"169.254.170.23"!==e.hostname&&"[fd00:ec2::23]"!==e.hostname){if(e.hostname.includes("[")){if("[::1]"===e.hostname||"[0000:0000:0000:0000:0000:0000:0000:0001]"===e.hostname)return}else{if("localhost"===e.hostname)return;const t=e.hostname.split("."),r=e=>{const t=parseInt(e,10);return 0<=t&&t<=255};if("127"===t[0]&&r(t[1])&&r(t[2])&&r(t[3])&&4===t.length)return}throw new O("URL not accepted. It must either be HTTPS or match one of the following:\n  - loopback CIDR 127.0.0.0/8 or [::1/128]\n  - ECS container host 169.254.170.2\n  - EKS container host 169.254.170.23 or [fd00:ec2::23]",{logger:t})}})(a,e.logger);const c=new E({requestTimeout:e.timeout??1e3,connectionTimeout:e.timeout??1e3});return u=async()=>{const t=function(e){return new l({protocol:e.protocol,hostname:e.hostname,port:Number(e.port),path:e.pathname,query:Array.from(e.searchParams.entries()).reduce(((e,[t,r])=>(e[t]=r,e)),{}),fragment:e.hash})}(a);n?t.headers.Authorization=n:s&&(t.headers.Authorization=(await N().readFile(s)).toString());try{return async function(e,t){const r=(e=>{if(!(e instanceof T.Readable))try{return(e=>{if(!D(e)&&!q(e))throw new Error(`Unexpected stream implementation, expect Blob or ReadableStream, got ${e?.__proto__?.constructor?.name||e}`);let t=!1;const r=async()=>{if(t)throw new Error(B);return t=!0,await(e=>"function"==typeof Blob&&e instanceof Blob?async function(e){const t=await function(e){return new Promise(((t,r)=>{const o=new FileReader;o.onloadend=()=>{if(2!==o.readyState)return r(new Error("Reader aborted too early"));const e=o.result??"",n=e.indexOf(","),s=n>-1?n+1:e.length;t(e.substring(s))},o.onabort=()=>r(new Error("Read aborted")),o.onerror=()=>r(o.error),o.readAsDataURL(e)}))}(e),r=(e=>{if(3*e.length%4!=0)throw new TypeError("Incorrect padding on base64 string.");if(!_.exec(e))throw new TypeError("Invalid base64 string.");const t=x(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)})(t);return new Uint8Array(r)}(e):async function(e){const t=[],r=e.getReader();let o=!1,n=0;for(;!o;){const{done:e,value:s}=await r.read();s&&(t.push(s),n+=s.length),o=e}const s=new Uint8Array(n);let i=0;for(const e of t)s.set(e,i),i+=e.length;return s}(e))(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();if("base64"===e)return(e=>{let t;if(t="string"==typeof e?(e=>{const t=x(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)})(e):e,"object"!=typeof t||"number"!=typeof t.byteOffset||"number"!=typeof t.byteLength)throw new Error("@smithy/util-base64: toBase64 encoder function only accepts string | Uint8Array.");return $(t.buffer,t.byteOffset,t.byteLength).toString("base64")})(t);if("hex"===e)return function(e){let t="";for(let r=0;r<e.byteLength;r++)t+=L[e[r]];return t}(t);if(void 0===e||"utf8"===e||"utf-8"===e)return(e=>{if("string"==typeof e)return e;if("object"!=typeof e||"number"!=typeof e.byteOffset||"number"!=typeof e.byteLength)throw new Error("@smithy/util-utf8: toUtf8 encoder function only accepts string | Uint8Array.");return $(e.buffer,e.byteOffset,e.byteLength).toString("utf8")})(t);if("function"==typeof TextDecoder)return new TextDecoder(e).decode(t);throw new Error("TextDecoder is not available, please make sure polyfill is provided.")},transformToWebStream:()=>{if(t)throw new Error(B);if(t=!0,D(e))return(e=>{if("function"!=typeof e.stream)throw new Error("Cannot transform payload Blob to web stream. Please make sure the Blob.stream() is polyfilled.\nIf you are using React Native, this API is not yet supported, see: https://react-native.canny.io/feature-requests/p/fetch-streaming-body");return e.stream()})(e);if(q(e))return e;throw new Error(`Cannot transform payload to web stream, got ${e}`)}})})(e)}catch(t){throw new Error(`Unexpected stream implementation, expect Stream.Readable instance, got ${e?.__proto__?.constructor?.name||e}`)}let t=!1;const r=async()=>{if(t)throw new Error(H);return t=!0,await S(e)};return Object.assign(e,{transformToByteArray:r,transformToString:async e=>{const t=await r();return void 0===e||Buffer.isEncoding(e)?$(t.buffer,t.byteOffset,t.byteLength).toString(e):new P.TextDecoder(e).decode(t)},transformToWebStream:()=>{if(t)throw new Error(H);if(null!==e.readableFlowing)throw new Error("The stream has been consumed by other callbacks.");if("function"!=typeof T.Readable.toWeb)throw new Error("Readable.toWeb() is not supported. Please make sure you are using Node.js >= 17.0.0, or polyfill is available.");return t=!0,T.Readable.toWeb(e)}})})(e.body),o=await r.transformToString();if(200===e.statusCode){const e=JSON.parse(o);if("string"!=typeof e.AccessKeyId||"string"!=typeof e.SecretAccessKey||"string"!=typeof e.Token||"string"!=typeof e.Expiration)throw new O("HTTP credential provider response not of the required format, an object matching: { AccessKeyId: string, SecretAccessKey: string, Token: string, Expiration: string(rfc3339) }",{logger:t});return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:Y(e.Expiration)}}if(e.statusCode>=400&&e.statusCode<500){let r={};try{r=JSON.parse(o)}catch(e){}throw Object.assign(new O(`Server responded with status: ${e.statusCode}`,{logger:t}),{Code:r.Code,Message:r.Message})}throw new O(`Server responded with status: ${e.statusCode}`,{logger:t})}((await c.handle(t)).response)}catch(t){throw new O(String(t),{logger:e.logger})}},f=e.maxRetries??3,h=e.timeout??1e3,async()=>{for(let e=0;e<f;++e)try{return await u()}catch(e){await new Promise((e=>setTimeout(e,h)))}return await u()};var u,f,h}}};